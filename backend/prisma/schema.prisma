generator client {
  provider     = "prisma-client"
  output       = "../generated/prisma"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
}

model User {
  id String @id @default(uuid())

  name        String
  lastName    String
  avatarUrl   String?
  password    String
  // email    String  @unique
  phoneNumber String  @unique

  role UserRole @default(REGULAR)

  plan Plan @default(START)

  stores Store[] @relation("user_stores_store_user")

  createdAt DateTime @default(now()) @map("created_at")

  @@map("users")
}

enum Plan {
  START
  ADVANCED
  PRO
}

enum UserRole {
  REGULAR
  ADMIN
}

model Store {
  id String @id @default(uuid())

  name String

  user   User   @relation("user_stores_store_user", fields: [userId], references: [id], onDelete: Cascade)
  userId String

  products Product[] @relation("store_product_product_store")

  @@unique([name, userId])
  @@map("stores")
}

model Product {
  id String @id @default(uuid())

  name            String
  description     String?
  imgUrl          String? @map("img_url")
  barcode         String? @map("bar_code")
  article         String?
  brand           String?
  category        String?
  container       String?
  containerNumber Int?    @map("container_number")
  options         String?

  quantity Int @default(0)

  unit Unit

  price         Float
  discountPrice Int?  @map("discount_price")

  stores Store[] @relation("store_product_product_store")

  createdAt DateTime @default(now()) @map("created_at")

  @@map("products")
}

enum Unit {
  PCS // штука
  KG // килограмм
  G // грамм
  L // литр
  ML // миллилитр
  M // метр
  CM // сантиметр
  MM // миллиметр
  PACK // упаковка
  BOX // коробка
  SET // набор
}
